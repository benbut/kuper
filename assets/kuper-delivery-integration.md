# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ö—É–ø–µ—Ä–∞ - –ö—É–ø–µ—Ä API

–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ç–∏–ø–∞ **"–°–±–æ—Ä–∫–∞ –º–µ—Ä—á–∞–Ω—Ç–∞, –¥–æ—Å—Ç–∞–≤–∫–∞ –ö—É–ø–µ—Ä–∞"** –¥–ª—è Push-–º–æ–¥–µ–ª–∏ –ö—É–ø–µ—Ä API.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

–ü—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ö—É–ø–µ—Ä–∞:
- **–ú–µ—Ä—á–∞–Ω—Ç** —Å–æ–±–∏—Ä–∞–µ—Ç –∑–∞–∫–∞–∑ –≤ —Å–≤–æ–µ–º –º–∞–≥–∞–∑–∏–Ω–µ
- **–ö—É–ø–µ—Ä** –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É —á–µ—Ä–µ–∑ —Å–≤–æ–∏—Ö –∫—É—Ä—å–µ—Ä–æ–≤
- **–ö—É–ø–µ—Ä** –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞
- **–ú–µ—Ä—á–∞–Ω—Ç** –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –∫—É—Ä—å–µ—Ä–∞ –∏ –¥–æ—Å—Ç–∞–≤–∫–∏

## üîÑ –û—Å–Ω–æ–≤–Ω–∞—è –±–ª–æ–∫-—Å—Ö–µ–º–∞

```mermaid
flowchart TD
    Start([–ö–ª–∏–µ–Ω—Ç –æ—Ñ–æ—Ä–º–ª—è–µ—Ç –∑–∞–∫–∞–∑ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π]) --> A[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook: order.created]
    A --> B{–ú–µ—Ä—á–∞–Ω—Ç –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–∫–∞–∑?}
    
    B -->|–î–∞| C[–ú–µ—Ä—á–∞–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç: {status: "created", number: "ID"}]
    B -->|–ù–µ—Ç| D[–ú–µ—Ä—á–∞–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç: {status: "created"}, –∑–∞—Ç–µ–º order.canceled]
    
    C --> E{–ó–∞–∫–∞–∑ –∏–∑ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞?}
    E -->|–î–∞| F[–ú–µ—Ä—á–∞–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.accepted]
    E -->|–ù–µ—Ç| G[–ú–µ—Ä—á–∞–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–±–æ—Ä–∫—É]
    F --> G
    
    G --> H[–ú–µ—Ä—á–∞–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.in_work]
    H --> I[–ö—É–ø–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–∏—Å–∫ –∫—É—Ä—å–µ—Ä–∞]
    I --> J{–ö—É—Ä—å–µ—Ä –Ω–∞–π–¥–µ–Ω?}
    J -->|–î–∞| K[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: courier.assigned]
    J -->|–ù–µ—Ç| L[–ú–µ—Ä—á–∞–Ω—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å–±–æ—Ä–∫—É]
    K --> M{–ö—É—Ä—å–µ—Ä –ø—Ä–∏–±—ã–ª?}
    M -->|–î–∞| N[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: courier.arrived]
    M -->|–ù–µ—Ç| L
    N --> L
    
    L --> O[–ú–µ—Ä—á–∞–Ω—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –∑–∞–∫–∞–∑]
    O --> P[–ú–µ—Ä—á–∞–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.assembled]
    P --> Q[–ú–µ—Ä—á–∞–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.ready_for_delivery + –∏—Ç–æ–≥–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤]
    
    Q --> R[–ö—É–ø–µ—Ä —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Å—É–º–º—É]
    R --> S[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook: order.paid]
    S --> T[–ö—É—Ä—å–µ—Ä –∑–∞–±–∏—Ä–∞–µ—Ç –∑–∞–∫–∞–∑]
    T --> U[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.received]
    U --> V[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.delivering]
    V --> W[–ö—É—Ä—å–µ—Ä –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–∫–∞–∑]
    W --> X[–ö—É–ø–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: order.delivered]
    
    D --> Cancel[–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω]
    X --> End([–ó–∞–∫–∞–∑ –∑–∞–≤–µ—Ä—à–µ–Ω])
    Cancel --> End
    
    subgraph "–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–º–µ–Ω—ã"
        AnyCancel[order.canceled —Å –ø—Ä–∏—á–∏–Ω–æ–π –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏]
    end
    
    style Start fill:#e8f5e8
    style End fill:#c8e6c9
    style Cancel fill:#ffcdd2
    style A fill:#fff3e0
    style H fill:#fff3e0
    style K fill:#e1f5fe
    style N fill:#e1f5fe
    style P fill:#fff3e0
    style Q fill:#fff3e0
    style S fill:#e1f5fe
    style U fill:#e1f5fe
    style V fill:#e1f5fe
    style X fill:#e1f5fe
```

## üì± –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

```mermaid
sequenceDiagram
    participant Client as –ö–ª–∏–µ–Ω—Ç
    participant Kuper as –ö—É–ø–µ—Ä
    participant Merchant as –ú–µ—Ä—á–∞–Ω—Ç
    participant Courier as –ö—É—Ä—å–µ—Ä
    
    Client->>Kuper: –û—Ñ–æ—Ä–º–ª—è–µ—Ç –∑–∞–∫–∞–∑ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π
    Note over Kuper: –°–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ –≤ —Å–∏—Å—Ç–µ–º–µ
    
    Kuper->>Merchant: webhook: order.created
    Note over Merchant: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
    
    alt –ó–∞–∫–∞–∑ –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
        Merchant->>Kuper: response: {status: "created", number: "MERCHANT_ID"}
        
        opt –ó–∞–∫–∞–∑ –∏–∑ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
            Merchant->>Kuper: notification: order.accepted
            Note over Kuper: –§–∏–∫—Å–∏—Ä—É–µ—Ç –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–∫–∞–∑–∞
        end
        
        Merchant->>Kuper: notification: order.in_work
        Note over Kuper: –ù–∞—á–∏–Ω–∞–µ—Ç –ø–æ–∏—Å–∫ –∫—É—Ä—å–µ—Ä–∞
        
        opt –ö—É—Ä—å–µ—Ä –Ω–∞–π–¥–µ–Ω –±—ã—Å—Ç—Ä–æ
            Kuper->>Merchant: webhook: courier.assigned
            Note over Merchant: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—å–µ—Ä–µ
        end
        
        opt –ö—É—Ä—å–µ—Ä –ø—Ä–∏–±—ã–ª –≤ –º–∞–≥–∞–∑–∏–Ω
            Kuper->>Merchant: webhook: courier.arrived
            Note over Merchant: –ö—É—Ä—å–µ—Ä –≥–æ—Ç–æ–≤ –∑–∞–±—Ä–∞—Ç—å –∑–∞–∫–∞–∑
        end
        
        Note over Merchant: –°–æ–±–∏—Ä–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞
        Merchant->>Kuper: notification: order.assembled
        
        Merchant->>Kuper: notification: order.ready_for_delivery + –∏—Ç–æ–≥–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤
        Note over Kuper: –ü–æ–ª—É—á–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ—Å—Ç–∞–≤ –∏ —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É–º–º—É
        
        Kuper->>Merchant: webhook: order.paid
        Note over Kuper: –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
        
        Note over Courier: –ó–∞–±–∏—Ä–∞–µ—Ç –∑–∞–∫–∞–∑ —É –º–µ—Ä—á–∞–Ω—Ç–∞
        Kuper->>Merchant: webhook: order.received
        
        Kuper->>Merchant: webhook: order.delivering
        Note over Courier: –ö—É—Ä—å–µ—Ä –µ–¥–µ—Ç –∫ –∫–ª–∏–µ–Ω—Ç—É
        
        Note over Courier: –î–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–∫–∞–∑ –∫–ª–∏–µ–Ω—Ç—É
        Kuper->>Merchant: webhook: order.delivered
        Note over Kuper: –ó–∞–∫–∞–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ
        
    else –ó–∞–∫–∞–∑ –Ω–µ–ª—å–∑—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
        Merchant->>Kuper: response: {status: "created", number: "MERCHANT_ID"}
        Merchant->>Kuper: notification: order.canceled + –ø—Ä–∏—á–∏–Ω–∞
        Note over Kuper: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç—É
    end
    
    opt –û—Ç–º–µ–Ω–∞ –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ
        alt –û—Ç–º–µ–Ω–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ö—É–ø–µ—Ä–∞/–∫–ª–∏–µ–Ω—Ç–∞
            Kuper->>Merchant: webhook: order.canceled + –ø—Ä–∏—á–∏–Ω–∞
        else –û—Ç–º–µ–Ω–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –º–µ—Ä—á–∞–Ω—Ç–∞
            Merchant->>Kuper: notification: order.canceled + –ø—Ä–∏—á–∏–Ω–∞
        end
        Note over Kuper: –û—Ç–º–µ–Ω—è–µ—Ç –∫—É—Ä—å–µ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞
    end
    
    opt –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–∫–∞–∑–µ
        Kuper->>Merchant: webhook: order.updated + kind
        Note over Merchant: –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–µ
    end
```

## üéØ –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π

```mermaid
timeline
    title –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–∫–∞–∑–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ö—É–ø–µ—Ä–∞
    
    section –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ
        –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω : –ö–ª–∏–µ–Ω—Ç –≤—ã–±—Ä–∞–ª –¥–æ—Å—Ç–∞–≤–∫—É
                     : order.created ‚Üí response
        –ü—Ä–∏–Ω—è—Ç–∏–µ : order.accepted (–¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤)
                 : –ó–∞–∫–∞–∑ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º–µ –º–µ—Ä—á–∞–Ω—Ç–∞
        
    section –ü–æ–∏—Å–∫ –∫—É—Ä—å–µ—Ä–∞ –∏ —Å–±–æ—Ä–∫–∞
        –ù–∞—á–∞–ª–æ —Å–±–æ—Ä–∫–∏ : order.in_work
                     : –ö—É–ø–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–∏—Å–∫ –∫—É—Ä—å–µ—Ä–∞
                     : –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞: collecting
        –ö—É—Ä—å–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω : courier.assigned (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                       : –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—å–µ—Ä–µ
        –ö—É—Ä—å–µ—Ä –ø—Ä–∏–±—ã–ª : courier.arrived (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                     : –ö—É—Ä—å–µ—Ä –≥–æ—Ç–æ–≤ –∑–∞–±—Ä–∞—Ç—å –∑–∞–∫–∞–∑
        –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ : –ú–µ—Ä—á–∞–Ω—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏
                      : –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Å–æ—Å—Ç–∞–≤–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–±–æ—Ä–∫–∏ : order.assembled
                         : –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞: assembled
        
    section –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∏ –æ–ø–ª–∞—Ç–∞
        –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å : order.ready_for_delivery + –∏—Ç–æ–≥–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤
                   : –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞: ready_to_ship
        –°–ø–∏—Å–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã : –ö—É–ø–µ—Ä —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Å—É–º–º—É
                       : –°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã: paid
        –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã : order.paid (webhook)
                            : –î–µ–Ω—å–≥–∏ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –∑–∞ –∑–∞–∫–∞–∑–æ–º
        
    section –ó–∞–±–æ—Ä –∏ –¥–æ—Å—Ç–∞–≤–∫–∞
        –ó–∞–±–æ—Ä –∑–∞–∫–∞–∑–∞ : order.received
                    : –ö—É—Ä—å–µ—Ä –∑–∞–±—Ä–∞–ª –∑–∞–∫–∞–∑ —É –º–µ—Ä—á–∞–Ω—Ç–∞
                    : –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞: shipping
        –î–æ—Å—Ç–∞–≤–∫–∞ : order.delivering
                 : –ö—É—Ä—å–µ—Ä –µ–¥–µ—Ç –∫ –∫–ª–∏–µ–Ω—Ç—É
        –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ : order.delivered
                  : –ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∫–ª–∏–µ–Ω—Ç—É
                  : –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞: shipped
```

## üìã –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –ö—É–ø–µ—Ä–∞

### ‚úÖ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫—É—Ä—å–µ—Ä—Å–∫–æ–π —Å–ª—É–∂–±—ã:

1. **courier.assigned** - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫—É—Ä—å–µ—Ä–∞
   - –ü—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ `order.in_work`, –¥–æ `order.paid`
   - –°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫—É—Ä—å–µ—Ä–µ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, –≤–æ–∑–º–æ–∂–Ω–æ —Ñ–æ—Ç–æ)
   - –ú–æ–∂–µ—Ç –Ω–µ –ø—Ä–∏–π—Ç–∏, –µ—Å–ª–∏ –∫—É—Ä—å–µ—Ä –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç

2. **courier.arrived** - –ü—Ä–∏–±—ã—Ç–∏–µ –∫—É—Ä—å–µ—Ä–∞
   - –ü—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ `courier.assigned`, –¥–æ `order.paid`
   - –û–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫—É—Ä—å–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω–µ –∏ –≥–æ—Ç–æ–≤ –∑–∞–±—Ä–∞—Ç—å –∑–∞–∫–∞–∑
   - –ü–æ–º–æ–≥–∞–µ—Ç –º–µ—Ä—á–∞–Ω—Ç—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ –Ω—É–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É

3. **order.received** - –ó–∞–±–æ—Ä –∑–∞–∫–∞–∑–∞
   - –ü—Ä–∏—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ `order.paid`
   - –û–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫—É—Ä—å–µ—Ä –∑–∞–±—Ä–∞–ª –∑–∞–∫–∞–∑ –∏ –ø–æ–∫–∏–Ω—É–ª –º–∞–≥–∞–∑–∏–Ω
   - –° —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –∑–∞–∫–∞–∑ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É –∫—É—Ä—å–µ—Ä–∞

4. **order.delivering** - –ü—Ä–æ—Ü–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∏
   - –ö—É—Ä—å–µ—Ä –µ–¥–µ—Ç –∫ –∫–ª–∏–µ–Ω—Ç—É
   - –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫—É—Ä—å–µ—Ä–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

5. **order.delivered** - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏
   - –ö—É—Ä—å–µ—Ä –¥–æ—Å—Ç–∞–≤–∏–ª –∑–∞–∫–∞–∑ –∫–ª–∏–µ–Ω—Ç—É
   - –ó–∞–∫–∞–∑ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω

### üöö –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- –ö—É–ø–µ—Ä —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫—É—Ä—å–µ—Ä–∞–º–∏
- –ú–µ—Ä—á–∞–Ω—Ç –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∏
- –í—Å–µ –≤–µ–±—Ö—É–∫–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç –ö—É–ø–µ—Ä–∞
- –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∫—É—Ä—å–µ—Ä—Å–∫–æ–π —Å–ª—É–∂–±—ã

### üì¶ –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞–∫–∞–∑–∞ –∫—É—Ä—å–µ—Ä—É:

1. –ö—É—Ä—å–µ—Ä –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ –º–∞–≥–∞–∑–∏–Ω (–º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ `courier.arrived`)
2. –ú–µ—Ä—á–∞–Ω—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–±–æ—Ä–∫—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `order.ready_for_delivery`
3. –ö—É–ø–µ—Ä —Å–ø–∏—Å—ã–≤–∞–µ—Ç –æ–ø–ª–∞—Ç—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `order.paid`
4. –ö—É—Ä—å–µ—Ä –∑–∞–±–∏—Ä–∞–µ—Ç –∑–∞–∫–∞–∑ (–ø—Ä–∏—Ö–æ–¥–∏—Ç `order.received`)
5. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –¥–æ—Å—Ç–∞–≤–∫–∞ (–ø—Ä–∏—Ö–æ–¥–∏—Ç `order.delivering`)

## üì® –ü—Ä–∏–º–µ—Ä—ã –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç –ö—É–ø–µ—Ä–∞

### 1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫—É—Ä—å–µ—Ä–∞

```json
POST /your-webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "courier.assigned",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "courier": {
      "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
      "phone": "+7900123456"
    }
  }
}
```

### 2. –ü—Ä–∏–±—ã—Ç–∏–µ –∫—É—Ä—å–µ—Ä–∞

```json
POST /your-webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "courier.arrived",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "courier": {
      "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
      "phone": "+7900123456"
    }
  }
}
```

### 3. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã

```json
POST /your-webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.paid",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "payment": {
      "amount": "189.99",
      "currency": "RUB",
      "method": "card"
    }
  }
}
```

### 4. –ó–∞–±–æ—Ä –∑–∞–∫–∞–∑–∞ –∫—É—Ä—å–µ—Ä–æ–º

```json
POST /your-webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.received",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "courier": {
      "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
      "phone": "+7900123456"
    }
  }
}
```

### 5. –ù–∞—á–∞–ª–æ –¥–æ—Å—Ç–∞–≤–∫–∏

```json
POST /your-webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.delivering",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "estimatedDeliveryTime": "2024-01-15T16:30:00+03:00"
  }
}
```

### 6. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏

```json
POST /your-webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.delivered",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "deliveredAt": "2024-01-15T16:25:00+03:00"
  }
}
```

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

### üî¥ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π**:
   - `courier.assigned/arrived` ‚Üí **–¥–æ** `order.paid`
   - `order.received/delivering/delivered` ‚Üí **–ø–æ—Å–ª–µ** `order.paid`

2. **–í order.ready_for_delivery –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤** –∑–∞–∫–∞–∑–∞

3. **–û—Ç–≤–µ—á–∞—Ç—å —É—Å–ø–µ—à–Ω–æ –Ω–∞ –≤—Å–µ –≤–µ–±—Ö—É–∫–∏ –æ—Ç –ö—É–ø–µ—Ä–∞** (—Å—Ç–∞—Ç—É—Å 200)

4. **–ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å order.delivered –æ—Ç –º–µ—Ä—á–∞–Ω—Ç–∞** - –¥–æ—Å—Ç–∞–≤–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –ö—É–ø–µ—Ä–æ–º

### üì± UX –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:

- –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–º –∫—É—Ä—å–µ—Ä–µ
- –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫—É—Ä—å–µ—Ä–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
- –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –¥–æ—Å—Ç–∞–≤–∫–∏
- –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∞–≤–∫–∏

### üè™ –ü—Ä–æ—Ü–µ—Å—Å –≤ –º–∞–≥–∞–∑–∏–Ω–µ:

1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ –ø—Ä–∏—Ö–æ–¥—É –∫—É—Ä—å–µ—Ä–∞ –ø–æ—Å–ª–µ `courier.assigned/arrived`
2. –ë—ã—Å—Ç—Ä–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–±–æ—Ä–∫—É –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ `courier.arrived`
3. –ü–µ—Ä–µ–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∫—É—Ä—å–µ—Ä—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `order.paid`
4. –ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏ - —ç—Ç–æ –∑–æ–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ö—É–ø–µ—Ä–∞

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–∞ `courier.assigned` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫—É—Ä—å–µ—Ä–µ
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–∞ `courier.arrived` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ `order.ready_for_delivery` —Å –∏—Ç–æ–≥–æ–≤—ã–º —Å–æ—Å—Ç–∞–≤–æ–º
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ `order.paid` –∫–∞–∫ —Å–∏–≥–Ω–∞–ª–∞ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∑–∞–∫–∞–∑–∞ –∫—É—Ä—å–µ—Ä—É
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ `order.received/delivering/delivered` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç –ö—É–ø–µ—Ä–∞

### üîÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ –ø—Ä–∏–±—ã—Ç–∏–∏ –∫—É—Ä—å–µ—Ä–∞
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫—É—Ä—å–µ—Ä–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- [ ] –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º–∏ –∫—É—Ä—å–µ—Ä–∞–º–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–ª–∞–¥–æ–º
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞

### üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

- [ ] –£—Å–ø–µ—à–Ω—ã–π –∑–∞–∫–∞–∑ —Å –±—ã—Å—Ç—Ä—ã–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º –∫—É—Ä—å–µ—Ä–∞
- [ ] –ó–∞–∫–∞–∑ –±–µ–∑ `courier.assigned` (–ø–æ–∑–¥–Ω–æ –Ω–∞–∑–Ω–∞—á–∏–ª–∏ –∫—É—Ä—å–µ—Ä–∞)
- [ ] –ó–∞–∫–∞–∑ —Å `courier.arrived` –ø–µ—Ä–µ–¥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å—é
- [ ] –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞ –ø–æ—Å–ª–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ –∑–∞–∫–∞–∑–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∫–∏
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ –≤ –¥–æ—Å—Ç–∞–≤–∫–µ

## üéØ –ü–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```
1. order.created (webhook –æ—Ç –ö—É–ø–µ—Ä–∞)
2. response: {status: "created", number: "ID"}
3. order.accepted (–¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤)
4. order.in_work
5. courier.assigned (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ order.paid)
6. courier.arrived (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ order.paid)
7. order.assembled
8. order.ready_for_delivery + –∏—Ç–æ–≥–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤
9. order.paid (webhook –æ—Ç –ö—É–ø–µ—Ä–∞)
10. order.received (webhook –æ—Ç –ö—É–ø–µ—Ä–∞)
11. order.delivering (webhook –æ—Ç –ö—É–ø–µ—Ä–∞)
12. order.delivered (webhook –æ—Ç –ö—É–ø–µ—Ä–∞)
```

### ‚ùå –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:

- –û—Ç–ø—Ä–∞–≤–∫–∞ `order.delivered` –æ—Ç –º–µ—Ä—á–∞–Ω—Ç–∞ (–¥–æ—Å—Ç–∞–≤–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –ö—É–ø–µ—Ä–æ–º)
- –û–∂–∏–¥–∞–Ω–∏–µ `courier.assigned` –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Å–±–æ—Ä–∫–∏
- –ü–µ—Ä–µ–¥–∞—á–∞ –∑–∞–∫–∞–∑–∞ –∫—É—Ä—å–µ—Ä—É –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è `order.paid`
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ `courier.arrived` –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–±–æ—Ä–∫–∏

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

### üìà –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

1. **–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ `courier.assigned`** - –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–π—Ç–µ —Å–±–æ—Ä–∫—É —ç—Ç–æ–≥–æ –∑–∞–∫–∞–∑–∞
2. **–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ `courier.arrived`** - —É—Å–∫–æ—Ä—å—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–±–æ—Ä–∫–∏
3. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –±—ã—Å—Ç—Ä—É—é —Å–±–æ—Ä–∫—É** - –∫—É—Ä—å–µ—Ä—ã –Ω–µ –ª—é–±—è—Ç –∂–¥–∞—Ç—å
4. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞** - —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–∞

### üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏:

- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ `courier.assigned/arrived` —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–∫–ª–∞–¥–∞
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ –ø—Ä–∏–±—ã—Ç–∏–∏ –∫—É—Ä—å–µ—Ä–∞
- –í–µ–¥–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—Ä–µ–º–µ–Ω–∏ —Å–±–æ—Ä–∫–∏ –∑–∞–∫–∞–∑–æ–≤
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫—É—Ä—å–µ—Ä–æ–≤

---

**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- [–û–±—â–∞—è —Å—Ö–µ–º–∞ Push-–º–æ–¥–µ–ª–∏](./kuper-push-model-flowchart.md)
- [–°–∞–º–æ–≤—ã–≤–æ–∑](./kuper-pickup-integration.md)
- [–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API](./kuper-api-reference.md)
- [–î–∏–∞–≥—Ä–∞–º–º—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π](./kuper-order-states.md)

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [docs.kuper.ru](https://docs.kuper.ru/api-products/merchant-service/orders/description) 