# –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API –¥–ª—è Push-–º–æ–¥–µ–ª–∏ –ö—É–ø–µ—Ä API

## –ë–∞–∑–æ–≤—ã–µ endpoint'—ã

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | URL | –ú–µ—Ç–æ–¥ |
|------------|-----|--------|
| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –º–µ—Ä—á–∞–Ω—Ç–∞ | `https://merchant-api.sbermarket.ru/ofm/api/v1/notifications` | POST |
| –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ | `https://merchant-api.sbermarket.ru/auth/token` | POST |

## –í–µ–±—Ö—É–∫–∏ –æ—Ç –ö—É–ø–µ—Ä–∞ (–≤—Ö–æ–¥—è—â–∏–µ)

| –°–æ–±—ã—Ç–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç |
|---------|----------|-------------------|
| `order.created` | –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω | ‚úÖ `{status: "created", number: "ID"}` |
| `order.updated` | –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–∫–∞–∑–µ | ‚ùå –°—Ç–∞—Ç—É—Å 200 |
| `order.paid` | –ó–∞–∫–∞–∑ –æ–ø–ª–∞—á–µ–Ω | ‚ùå –°—Ç–∞—Ç—É—Å 200 |
| `order.canceled` | –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω | ‚ùå –°—Ç–∞—Ç—É—Å 200 |
| `order.delivered` | –ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω | ‚ùå –°—Ç–∞—Ç—É—Å 200 |
| `courier.assigned` | –ö—É—Ä—å–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω | ‚ùå –°—Ç–∞—Ç—É—Å 200 |
| `courier.arrived` | –ö—É—Ä—å–µ—Ä –ø—Ä–∏–±—ã–ª | ‚ùå –°—Ç–∞—Ç—É—Å 200 |
| `order.received` | –ö—É—Ä—å–µ—Ä –∑–∞–±—Ä–∞–ª –∑–∞–∫–∞–∑ | ‚ùå –°—Ç–∞—Ç—É—Å 200 |

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –º–µ—Ä—á–∞–Ω—Ç–∞ (–∏—Å—Ö–æ–¥—è—â–∏–µ)

| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å |
|-------------|----------|------------------|
| `order.accepted` | –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç | –î–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –ø–æ—Å–ª–µ `order.created` |
| `order.in_work` | –°–±–æ—Ä–∫–∞ –Ω–∞—á–∞–ª–∞—Å—å | –ü—Ä–∏ –Ω–∞—á–∞–ª–µ —Å–±–æ—Ä–∫–∏ |
| `order.assembled` | –ó–∞–∫–∞–∑ —Å–æ–±—Ä–∞–Ω | –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ |
| `order.ready_for_delivery` | –ì–æ—Ç–æ–≤ –∫ –≤—ã–¥–∞—á–µ | –ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ + –∏—Ç–æ–≥–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤ |
| `order.canceled` | –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞ | –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –º–µ—Ä—á–∞–Ω—Ç–∞ |
| `order.pickup_code_created` | –ö–æ–¥ –≤—ã–¥–∞—á–∏ —Å–æ–∑–¥–∞–Ω | –¢–æ–ª—å–∫–æ –¥–ª—è —Å–∞–º–æ–≤—ã–≤–æ–∑–∞ |
| `order.delivered` | –ó–∞–∫–∞–∑ –≤—ã–¥–∞–Ω | –¢–æ–ª—å–∫–æ –¥–ª—è —Å–∞–º–æ–≤—ã–≤–æ–∑–∞/—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ |

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### 1. –û—Ç–≤–µ—Ç –Ω–∞ order.created

```json
POST /webhook-endpoint
Content-Type: application/json
Authorization: Bearer your-token

Response:
{
  "status": "created",
  "number": "MERCHANT_ORDER_12345",
  "expectedAssemblyTime": "2024-01-15T14:30:00+03:00"
}
```

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ order.in_work

```json
POST https://merchant-api.sbermarket.ru/ofm/api/v1/notifications
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.in_work",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345"
  }
}
```

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ order.ready_for_delivery

```json
POST https://merchant-api.sbermarket.ru/ofm/api/v1/notifications
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.ready_for_delivery",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "positions": [
      {
        "id": "123456",
        "quantity": 1,
        "price": "199.99",
        "discountPrice": "189.99",
        "totalPrice": "189.99",
        "weight": "500"
      }
    ],
    "total": {
      "totalPrice": "189.99",
      "discountTotalPrice": "189.99"
    }
  }
}
```

### 4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ order.canceled

```json
POST https://merchant-api.sbermarket.ru/ofm/api/v1/notifications
Content-Type: application/json
Authorization: Bearer your-token

{
  "event_type": "order.canceled",
  "payload": {
    "orderUUID": "retailer-slug:265cb601-a78a-4862-9e9d-d6b48d6a0a3f",
    "number": "MERCHANT_ORDER_12345",
    "cancellation": {
      "slug": "store_closed",
      "description": "–ú–∞–≥–∞–∑–∏–Ω –∑–∞–∫—Ä—ã—Ç –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"
    }
  }
}
```

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| HTTP Status | –û–ø–∏—Å–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|-------------|----------|----------|
| 200 | –£—Å–ø–µ—à–Ω–æ | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É |
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö |
| 401 | –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω |
| 404 | –ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å orderUUID |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ | –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ |

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏

```http
Content-Type: application/json
Authorization: Bearer YOUR_ACCESS_TOKEN
```

## –ö–æ–¥—ã –ø—Ä–∏—á–∏–Ω –æ—Ç–º–µ–Ω—ã

| Slug | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `store_closed` | –ú–∞–≥–∞–∑–∏–Ω –∑–∞–∫—Ä—ã—Ç |
| `out_of_stock` | –¢–æ–≤–∞—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| `technical_issues` | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã |
| `order_not_paid` | –ó–∞–∫–∞–∑ –Ω–µ –æ–ø–ª–∞—á–µ–Ω |
| `customer_request` | –ó–∞–ø—Ä–æ—Å –∫–ª–∏–µ–Ω—Ç–∞ |

## –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

- [ ] Endpoint –¥–ª—è –ø—Ä–∏–µ–º–∞ –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç –ö—É–ø–µ—Ä–∞
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –≤–µ–±—Ö—É–∫–æ–≤ (Basic Auth –∏–ª–∏ client-token)
- [ ] –û—Ç–≤–µ—Ç –Ω–∞ `order.created` –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è `order.in_work`
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è `order.assembled`
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è `order.ready_for_delivery` —Å –∏—Ç–æ–≥–æ–≤—ã–º —Å–æ—Å—Ç–∞–≤–æ–º
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–º–µ–Ω —á–µ—Ä–µ–∑ `order.canceled`
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –∏ –∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### üîÑ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

- [ ] –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –æ—à–∏–±–∫–∏
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤–µ–±—Ö—É–∫–æ–≤
- [ ] Timeout'—ã –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **–£—Å–ø–µ—à–Ω—ã–π –∑–∞–∫–∞–∑**: order.created ‚Üí order.in_work ‚Üí order.assembled ‚Üí order.ready_for_delivery ‚Üí order.paid ‚Üí order.delivered
2. **–û—Ç–º–µ–Ω–∞ –º–µ—Ä—á–∞–Ω—Ç–æ–º**: order.created ‚Üí order.canceled (–æ—Ç –º–µ—Ä—á–∞–Ω—Ç–∞)
3. **–û—Ç–º–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–º**: order.created ‚Üí order.canceled (–æ—Ç –ö—É–ø–µ—Ä–∞)
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞**: order.created ‚Üí order.updated ‚Üí –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
5. **–†–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã–π –∑–∞–∫–∞–∑**: order.created ‚Üí order.accepted ‚Üí –¥–∞–ª—å—à–µ –ø–æ –æ–±—ã—á–Ω–æ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [docs.kuper.ru](https://docs.kuper.ru/api-products/merchant-service/orders/description) 